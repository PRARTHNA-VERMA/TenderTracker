@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor Accessor
@model TenderTracker.Models.ExcelViewUpload

@{
	ViewData["Title"] = "Upload Excel";

	//Layout = "~/Views/Shared/_Layout.cshtml";
	Layout = "~/Views/Shared/_DashboardLayout.cshtml";
}

@* @model ExcelViewUpload *@
@using System.Data

@if (TempData["SuccessMessage"] != null)
{
	<script>
		alert('@TempData["SuccessMessage"]');
	</script>
}
@if (TempData["ErrorMessage"] != null)
{
	<script>
		alert('@TempData["ErrorMessage"]');
	</script>
}

<head>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/css/adminlte.min.css">
	<!-- Google Font: Source Sans Pro -->
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">

</head>

<div class="">
	<section class="container">
		<div class="row">
			<div class="col-md-2">
				</div>
			<div class="col-md-8">
				<div class="card card-primary mt-2">
				<div class="card-header">
					<h3 class="card-title text-center">Upload Excel Sheet</h3>
				</div>

				<form asp-action="ViewExcel" asp-controller="Dashboard" method="post" enctype="multipart/form-data">
						<div class="card-body">
							<div class="form-group">
								<label for="exampleInputFile">Choose an Excel file</label>
								<div class="input-group">
									<div class="custom-file">
										<input type="file" asp-for="ExcelUpload" class="custom-file-input" id="exampleInputFile"
											   accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">
										<label class="custom-file-label" for="exampleInputFile">Choose file</label>
									</div>
								</div>
							</div>
							<button type="submit" class="btn btn-primary">Upload</button>
						</div>
					<div class="card-footer">
						@* <button type="submit" class="btn btn-primary my-0">Upload Excel</button> *@
						@* <button type="button" class="btn btn-primary">Upload CV</button> *@
					</div>
				</form>
				</div>
			</div>

		@* 	<div class="col-md-6">
				<div class="card card-primary mt-2 my-1">
					<div class="card-header">
						<h3 class="card-title text-center">Upload Files</h3>
					</div>

					<form asp-action="UploadFile" asp-controller="Dashboard" method="post" enctype="multipart/form-data">
						<div class="form-group my-4 mx-3">

							<label for="fileUpload" class="my-2">Upload PDF Files</label>
							<br />
							<input type="file" id="fileUpload" name="files" multiple accept=".pdf">
							<small class="form-text my-3 text-muted">Select files to upload.</small>
						</div>
						<div class="card-footer">
							<button type="submit" class="btn btn-primary my-0 mx-3">Upload Files</button>
						</div>
					</form>
				</div>
			</div>
		 *@
		</div>

				<div class="card-footer">
						@* <button type="submit" class="btn btn-primary">Upload Folder</button> *@
						
	</section>
</div>

<script src="https://cdn.datatables.net/1.10.23/js/dataTables.bootstrap.min.js"></script>
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/jquery/dist/jquery.js"></script>

<script src="https://code.jquery.com/jquery-3.7.1.js"></script>
<script src="https://cdn.datatables.net/2.1.5/js/dataTables.js"></script>


<script>
	// Update file name in label when file is selected
	document.getElementById("exampleInputFile").addEventListener("change", function() {
		var fileName = this.files[0] ? this.files[0].name : "Choose file";
		this.nextElementSibling.innerText = fileName;
	});
</script>
<script>
	$(document).ready(function () {
		$('#example').DataTable();
	});
</script>

<script src="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/js/adminlte.min.js"></script>
<script src="../../plugins/bs-custom-file-input/bs-custom-file-input.min.js"></script>
<script src="~/js/site.js"></script>
<script>
	$(function () {
		bsCustomFileInput.init();
	});
</script>
<a href="~/lib/jquery/dist/jquery.min.map"></a>
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/jquery/dist/jquery.js"></script>

<script>
	document.querySelector('.custom-file-input').addEventListener('change', function (e) {
		const fileName = e.target.files[0]?.name; // Get selected file name
		if (fileName) {
			e.target.nextElementSibling.textContent = fileName; // Update label text
			document.getElementById('fileName').textContent = `Selected file: ${fileName}`;
		} else {
			document.getElementById('fileName').textContent = 'No file selected.';
		}
	});
</script>
<script>
	document.querySelector('.custom-file-input').addEventListener('change', function (e) {
		const fileName = e.target.files[0]?.name;
		const allowedExtensions = /(\.csv|\.xls|\.xlsx)$/i;

		if (fileName) {
			if (!allowedExtensions.exec(fileName)) {
				alert('Invalid file type. Please upload only CSV or Excel files.');
				e.target.value = ''; // Clear the input
				e.target.nextElementSibling.textContent = 'Choose file'; // Reset the label
				return;
			}
			e.target.nextElementSibling.textContent = fileName; // Update label text
			document.getElementById('fileName').textContent = `Selected file: ${fileName}`;
		} else {
			document.getElementById('fileName').textContent = 'No file selected.';
		}
	});
</script>
<script type="text/javascript">
	$(document).ready(function () {
		$('form').on('submit', function (e) {
			var confirmed = confirm("Are you sure you want to submit?");
			if (!confirmed) {
				e.preventDefault(); // Cancel the form submission
			}
		});
	});
</script>
